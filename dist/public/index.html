<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="select2/css/select2.min.css" />
    <link rel="stylesheet" href="jsTree/themes/default/style.min.css" />
    <link rel="stylesheet" href="handsontable/handsontable.full.min.css" />
    <link rel="stylesheet" href="main.css">
    <title>ND Import File Generator</title>
</head>
<body>
    <div class="cont-outer">
        <div class="info">
            <div class="title">
                <h1>ND Mass Import File Generation Utility</h1>
            </div>
            <p>
                This tool is meant to help with the generation of the CSV file required by the ND Mass Import Tool. It interfaces with the Matters_With_Contacts.csv
                and the Data/ directory to make assigning profile data to documents quicker. The instructions on this page will refer to documents that have been
                added to your import as "profiled".
            </p>
        </div>
        <div class="content">
            <div class="left-bar">
                <div id="filetree"></div>
                <div id="legend">
                    <p>Colors Legend: </p>
                    <div class="split">
                        <div class="half">
                            <p>Document Type(s)</p>
                            <ul>
                                <li style="background-color: #d3d3d3;">No Doc Type</li>
                                <li style="background-color: #64ea74;">Correspondence</li>
                                <li style="background-color: #5bebc5;">Discovery</li>
                                <li style="background-color: #5aa0e6;">Drafted Documents</li>
                                <li style="background-color: #b678ec;">Executed Documents</li>
                                <li style="background-color: #f5a453;">Pleadings</li>
                                <li style="background-color: #e4e05d;">Retainer and Notes</li>
                                <li style="background-color: #ea71b5;">Source Documents</li>
                            </ul>
                        </div>
                        <div class="half">
                            <p>Profile Status</p>
                            <ul>
                                <li style="background-color: #0ce313;">Document/Folder Fully Included in Import</li>
                                <li style="background-color: #27ffff;">Folder Partially Included in Import</li>
                                <li style="background-color: #fd5a5a;">Document/Folder is Missing Something</li>
                            </ul>
                        </div>
                    </div>
                    <p>
                        Items will not include these colors until they have been profiled. The main section of the bar shows doc type(s), and the right edge
                        shows the status. Folders that include profiled documents of multiple types will show multiple colors to represent all their contents.
                        An example is given below of what you would see if a folder included documents with the 'Correspondence' and 'Discovery' doc types. The
                        green on the right edge means all the documents in the folder have been profiled.
                    </p>
                </div>
            </div>
            <div class="right-bar">
                <div class="section">
                    <p><span id="num-selected">0</span> items selected.</p>
                </div>
                <div class="separator"></div>
                <div class="section">
                    <p>
                        <span class='input-label'>Client: </span><select id="client-select"></select>
                    </p>
                </div>
                <div class="section">
                    <p>
                        <span class='input-label'>Matter: </span><select id="matter-select"></select>
                    </p>
                </div>
                <div class="section">
                    <p>
                        <span class='input-label'>Doc Type: </span><select id="doctype-select">
                            <option value="">No Doc Type</option>
                            <option value="Email">Emails</option>
                            <optgroup label="Court-Related Matters">
                                <option value="CORRES">Correspondence</option>
                                <option value="DISC">Discovery</option>
                                <option value="PLEADING">Pleadings</option>
                                <option value="NOTES">Retainer and Notes</option>
                                <option value="SOURCE DOCS">Source Documents</option>
                            </optgroup>
                            <optgroup label="Transactional Matters">
                                <option value="CORRES">Correspondence</option>
                                <option value="DRAFT">Drafted Documents</option>
                                <option value="EXECUTED">Executed Documents</option>
                                <option value="SOURCE DOCS">Source Documents</option>
                            </optgroup>
                        </select>
                    </p>
                </div>
                <div class="section">
                    <p>
                        <input type="checkbox" id="recursive" /> Apply settings to folders recursively
                    </p>
                </div>
                <div class="section">
                    <p>
                        <button id="apply-settings">Apply Settings to Selected Files</button>
                    </p>
                </div>
                <div class="separator"></div>
                <div class="section">
                    <p>
                        <span id="num-files">0</span> Total Files in this Import.
                    </p>
                </div>
                <div class="section">
                    <p>
                        <span class="input-label">Output Title: </span><input type="text" id="filename-out" value="ImportDescription" />
                    </p>
                </div>
                <div class="section">
                    <p>
                        <button id="save-file">Save Import File</button>
                    </p>
                </div>
            </div>
        </div>
        <div class="info">
            <p>
                On the left side of the page, you will see a representation of the files in the Data/ directory. Here, you can select folders and/or files to add to this
                import. If you select a file and hold Shift, you can click another entry at a further point in the list to select several files. You can also hold 'CTRL'
                to select multiple files one-by-one. They can be kind of small and hard to see, but folders have an arrow to the left of them you can use to expand and
                hide their contents. Currently, you will need to expand a folder if you plan on selecting it to apply profile data to the files inside.
            </p>
            <p>
                <b>NOTE:</b> Because the Data/ directory is very large, it is not feasible to load everything every time you load the page. As a result of this issue, this app loads
                files dynamically, which means it doesnt know about a directory's contents until you've expanded it once.
            </p>
            <p>
                At the top of the right side, you can see how many items you have selected (this does not include folder contents, though it probably should //TODO). Below
                that, you can set the profile data for the documents you have selected (Client, Matter, Doc Type). If you enable 'Apply settings to folders recursively',
                all subfolders of the folder(s) you have selected will also be scanned for files when the 'Apply' button is pressed (currently, you must expand any and all
                subfolders manually if you want them to be included - see above).
            </p>
            <p>
                Once you have made your selections, press 'Apply Settings to Selected Files'. If you have selected at least one file, you should see the number in the section
                below change, indicating the CSV contents were generated. If you would like to include any other files in this import, repeat the process (do not refresh the page
                - nothing has been saved yet!)
            </p>
            <p>
                When you have applied the profile data and generated the CSV contents for all of the files for your import, you will want to make sure they are actually saved
                to a file somewhere. The final section on the right includes an area where you can set the title of this file (it can be whatever you want). Click the 'Save 
                Import File' button and your file will be generated. Currently, the output files are in the root directory of this tool, but I may make it give a 'Save As'
                prompt in the future (//TODO).
            </p>
        </div>
    </div>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="jquery-3.6.4.min.js"></script>
    <script type="text/javascript" src="select2/js/select2.min.js"></script>
    <script type="text/javascript" src="jsTree/jstree.min.js"></script>
    <script type="text/javascript" src="handsontable/handsontable.full.min.js"></script>
    <script type="text/javascript" src="index.js"></script>
</body>
</html>